<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Timetable</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .tab-button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px 8px 0 0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            background: #e0e0e0;
            color: #666;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .timetable-grid {
            display: grid;
            grid-template-columns: 80px repeat(5, 1fr);
            gap: 10px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .time-column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .time-label {
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #7f8c8d;
            font-size: 14px;
        }

        .day-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            border-radius: 8px;
            font-size: 16px;
        }

        .day-column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .time-slot {
            min-height: 60px;
            border: 2px dashed #e0e0e0;
            border-radius: 8px;
            padding: 5px;
            transition: all 0.2s;
            position: relative;
        }

        .time-slot:hover {
            background: #f8f9fa;
            border-color: #667eea;
        }

        .time-slot.drag-over {
            background: #e8eaf6;
            border-color: #667eea;
            border-style: solid;
        }

        .event-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px;
            border-radius: 6px;
            cursor: move;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            user-select: none;
            margin-bottom: 5px;
        }

        .event-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .event-card.dragging {
            opacity: 0.3;
            cursor: grabbing;
        }

        .event-card.compulsory {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            cursor: not-allowed;
        }

        .event-card.activity {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .event-card.break {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }

        .event-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .event-time {
            font-size: 12px;
            opacity: 0.9;
        }

        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .legend-color.compulsory {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .legend-color.activity {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .legend-color.break {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        .btn-save {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
        }

        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(39, 174, 96, 0.3);
        }

        .btn-reset {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            color: white;
        }

        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(230, 126, 34, 0.3);
        }

        /* List view styles */
        .day-list {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .day-title {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .event-list-item {
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 8px;
            border-left: 4px solid;
        }

        .event-list-item.compulsory {
            background: #fee;
            border-color: #e74c3c;
        }

        .event-list-item.activity {
            background: #e3f2fd;
            border-color: #3498db;
        }

        .event-list-item.break {
            background: #f5f5f5;
            border-color: #95a5a6;
        }

        .event-list-item strong {
            font-size: 16px;
            display: block;
            margin-bottom: 4px;
        }

        .event-list-item span {
            font-size: 14px;
            color: #666;
        }

        .empty-day {
            color: #bdc3c7;
            font-style: italic;
            padding: 20px;
            text-align: center;
        }

        .summary-stats {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            min-width: 150px;
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 5px;
        }

        @media (max-width: 1200px) {
            .timetable-grid {
                grid-template-columns: 60px repeat(5, 1fr);
                gap: 5px;
                padding: 10px;
            }

            .event-name {
                font-size: 12px;
            }

            .event-time {
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“… Interactive Weekly Timetable</h1>
        
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('grid')">ðŸŽ¯ Grid View</button>
            <button class="tab-button" onclick="switchTab('list')">ðŸ“‹ List View</button>
        </div>

        <!-- Grid View Tab -->
        <div id="grid-tab" class="tab-content active">
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color compulsory"></div>
                    <span>ðŸ”´ Compulsory (Locked)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color activity"></div>
                    <span>ðŸ”µ Activity (Draggable)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color break"></div>
                    <span>âšª Break</span>
                </div>
            </div>

            <div class="controls">
                <button class="btn-save" onclick="saveTimetable()">ðŸ’¾ Save Changes</button>
                <button class="btn-reset" onclick="resetTimetable()">ðŸ”„ Reset to Original</button>
            </div>

            <div class="timetable-grid" id="timetable">
                <!-- Grid will be generated by JavaScript -->
            </div>
        </div>

        <!-- List View Tab -->
        <div id="list-tab" class="tab-content">
            <div class="summary-stats" id="summary-stats">
                <!-- Summary will be generated by JavaScript -->
            </div>
            <div id="list-view">
                <!-- List will be generated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        const DAY_NAMES = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
        const TIME_SLOTS = [
            "06:00", "07:00", "08:00", "09:00", "10:00", "11:00", 
            "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", 
            "18:00", "19:00", "20:00", "21:00", "22:00"
        ];

        let timetableData = {
            "Monday": [
                {start: "09:00", end: "10:00", name: "Math Class", type: "COMPULSORY"},
                {start: "10:00", end: "12:00", name: "Break", type: "BREAK"},
                {start: "14:00", end: "15:00", name: "Study Session 1", type: "ACTIVITY"}
            ],
            "Tuesday": [
                {start: "08:00", end: "09:00", name: "English Class", type: "COMPULSORY"},
                {start: "15:00", end: "16:00", name: "Project Work", type: "ACTIVITY"}
            ],
            "Wednesday": [],
            "Thursday": [
                {start: "10:00", end: "11:00", name: "Team Meeting", type: "COMPULSORY"}
            ],
            "Friday": [
                {start: "16:00", end: "17:00", name: "Review Session", type: "ACTIVITY"}
            ]
        };

        let originalData = JSON.parse(JSON.stringify(timetableData));
        let draggedElement = null;
        let draggedEventData = null;
        let originalDay = null;
        let originalSlot = null;

        function switchTab(tab) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tab === 'grid') {
                document.querySelector('.tab-button:nth-child(1)').classList.add('active');
                document.getElementById('grid-tab').classList.add('active');
            } else {
                document.querySelector('.tab-button:nth-child(2)').classList.add('active');
                document.getElementById('list-tab').classList.add('active');
                renderListView();
            }
        }

        function timeToMinutes(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }

        function minutesToTime(minutes) {
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;
            return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;
        }

        function getEventsInSlot(day, time) {
            const timeMinutes = timeToMinutes(time);
            return timetableData[day].filter(event => {
                const startMinutes = timeToMinutes(event.start);
                const endMinutes = timeToMinutes(event.end);
                return timeMinutes >= startMinutes && timeMinutes < endMinutes;
            });
        }

        function renderTimetable() {
            const grid = document.getElementById('timetable');
            grid.innerHTML = '';

            grid.appendChild(createTimeLabel(''));
            DAY_NAMES.forEach(day => {
                const header = document.createElement('div');
                header.className = 'day-header';
                header.textContent = day;
                grid.appendChild(header);
            });

            TIME_SLOTS.forEach(time => {
                grid.appendChild(createTimeLabel(time));

                DAY_NAMES.forEach(day => {
                    const slot = createTimeSlot(day, time);
                    grid.appendChild(slot);
                });
            });
        }

        function createTimeLabel(time) {
            const label = document.createElement('div');
            label.className = 'time-label';
            label.textContent = time;
            return label;
        }

        function createTimeSlot(day, time) {
            const slot = document.createElement('div');
            slot.className = 'time-slot';
            slot.dataset.day = day;
            slot.dataset.time = time;

            const eventsInSlot = getEventsInSlot(day, time);
            
            eventsInSlot.forEach(event => {
                if (timeToMinutes(event.start) === timeToMinutes(time)) {
                    const card = createEventCard(event, day);
                    slot.appendChild(card);
                }
            });

            slot.addEventListener('dragover', handleDragOver);
            slot.addEventListener('drop', (e) => handleDrop(e, day, time, slot));
            slot.addEventListener('dragleave', handleDragLeave);

            return slot;
        }

        function createEventCard(event, day) {
            const card = document.createElement('div');
            card.className = `event-card ${event.type.toLowerCase()}`;
            card.draggable = event.type !== 'COMPULSORY';
            card.dataset.eventId = `${day}-${event.start}-${event.name}`;
            card.dataset.originalDay = day;

            const name = document.createElement('div');
            name.className = 'event-name';
            name.textContent = event.name;

            const time = document.createElement('div');
            time.className = 'event-time';
            time.textContent = `${event.start} - ${event.end}`;

            card.appendChild(name);
            card.appendChild(time);

            if (event.type !== 'COMPULSORY') {
                card.addEventListener('dragstart', (e) => handleDragStart(e, event, day));
                card.addEventListener('dragend', handleDragEnd);
            }

            return card;
        }

        function handleDragStart(e, event, day) {
            draggedElement = e.target;
            draggedEventData = {...event};
            originalDay = day;
            originalSlot = e.target.parentElement;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            e.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleDrop(e, targetDay, targetTime, targetSlot) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');

            if (!draggedEventData || draggedEventData.type === 'COMPULSORY') {
                return;
            }

            const startMinutes = timeToMinutes(draggedEventData.start);
            const endMinutes = timeToMinutes(draggedEventData.end);
            const duration = endMinutes - startMinutes;

            const newStartMinutes = timeToMinutes(targetTime);
            const newEndMinutes = newStartMinutes + duration;

            const newStart = minutesToTime(newStartMinutes);
            const newEnd = minutesToTime(newEndMinutes);

            // Check for conflicts
            const conflict = timetableData[targetDay].some(event => {
                const eventStart = timeToMinutes(event.start);
                const eventEnd = timeToMinutes(event.end);
                const isSameEvent = event.name === draggedEventData.name && 
                                    event.start === draggedEventData.start;
                if (isSameEvent) return false;
                return !(newEndMinutes <= eventStart || newStartMinutes >= eventEnd);
            });

            if (conflict) {
                alert('âš ï¸ Time slot is occupied!');
                return;
            }

            // Remove from original day
            const eventIndex = timetableData[originalDay].findIndex(
                event => event.name === draggedEventData.name && 
                         event.start === draggedEventData.start &&
                         event.type === draggedEventData.type
            );
            
            if (eventIndex !== -1) {
                timetableData[originalDay].splice(eventIndex, 1);
            }

            // Add to new day
            const newEvent = {
                ...draggedEventData,
                start: newStart,
                end: newEnd
            };
            timetableData[targetDay].push(newEvent);
            timetableData[targetDay].sort((a, b) => 
                timeToMinutes(a.start) - timeToMinutes(b.start)
            );

            renderTimetable();
        }

        function renderListView() {
            const listContainer = document.getElementById('list-view');
            const summaryContainer = document.getElementById('summary-stats');
            listContainer.innerHTML = '';
            summaryContainer.innerHTML = '';

            // Calculate summary stats
            let totalEvents = 0;
            let totalHours = 0;

            DAY_NAMES.forEach(day => {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'day-list';

                const title = document.createElement('div');
                title.className = 'day-title';
                title.textContent = `ðŸ“… ${day}`;
                dayDiv.appendChild(title);

                if (timetableData[day].length === 0) {
                    const empty = document.createElement('div');
                    empty.className = 'empty-day';
                    empty.textContent = 'No events scheduled';
                    dayDiv.appendChild(empty);
                } else {
                    timetableData[day].forEach(event => {
                        const item = document.createElement('div');
                        item.className = `event-list-item ${event.type.toLowerCase()}`;
                        
                        const emoji = event.type === 'COMPULSORY' ? 'ðŸ”´' : 
                                     event.type === 'ACTIVITY' ? 'ðŸ”µ' : 'âšª';
                        
                        item.innerHTML = `
                            <strong>${emoji} ${event.name}</strong>
                            <span>${event.start} - ${event.end}</span>
                        `;
                        dayDiv.appendChild(item);

                        totalEvents++;
                        const duration = (timeToMinutes(event.end) - timeToMinutes(event.start)) / 60;
                        if (event.type !== 'BREAK') totalHours += duration;
                    });
                }

                listContainer.appendChild(dayDiv);
            });

            // Add summary stats
            summaryContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${totalEvents}</div>
                    <div class="stat-label">Total Events</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${totalHours.toFixed(1)}h</div>
                    <div class="stat-label">Active Hours</div>
                </div>
            `;
        }

        function saveTimetable() {
            console.log('Saving timetable:', timetableData);
            alert('âœ… Timetable saved successfully!');
        }

        function resetTimetable() {
            if (confirm('Reset timetable to original state?')) {
                timetableData = JSON.parse(JSON.stringify(originalData));
                renderTimetable();
                if (document.getElementById('list-tab').classList.contains('active')) {
                    renderListView();
                }
            }
        }

        // Initialize
        renderTimetable();
    </script>
</body>
</html>
